## 预定义度量格式和度量格式字符



#### 预定义度量格式

| <span style="white-space:nowrap">格式名 &nbsp;&nbsp;</span> | 说明                                                         |
| :---------------------------------------------------------- | ------------------------------------------------------------ |
| 无格式                                                      | 不设置任何格式。                                             |
| 数值                                                        | 可选择是否带千位分隔符、负数的格式，可配置小数点分隔符后的位数，其中小数点分隔符左侧至少有一个数字。 |
| 货币                                                        | 可选择是否带千位分隔符、负数的格式，可配置小数点分隔符后的位数，显示的货币符号会基于系统区域设置。 |
| 百分比                                                      | 将数字乘以 100 后显示，并在右侧追加百分号 (%)。 可配置小数点分隔符后的位数。 |



#### 度量格式表达式结构

自定义格式表达式可以有一到三部分（各部分之间用分号分隔）。 

| 使用情况 | 说明                                                       |
| :----------------------------------------------------------- | ---------------------------------------------------------- |
| 一个部分                                                     | 格式表达式应用于所有值                                     |
| 两部分                                                       | 第一部分应用于正值和零，第二部分应用于负值。               |
| 三部分                                                       | 第一部分应用于正值，第二部分应用于负值，第三部分应用于零。 |

下面的示例有两部分。 第一部分定义正值和零的格式，第二部分定义负值的格式。

```
#,##0;(-#,##0)
```

下面的示例有三部分。 第一部分定义正值的格式，第二部分定义负值的格式，第三部分应用于零，即如果值为零，则显示“Zero”。

```
$#,##0;(-$#,##0);\Z\e\r\o
```



#### 度量格式字符

| 字符 | 说明 |
| :-----: | ---- |
| 0 | **表示显示数字或零 (0) 的数字占位符**。<br /><br />如果数字在格式字符串中出现零的位置有一个数字，则格式化的值将显示该数字。否则，格式化的值在该位置显示零。<br /><br />如果数字的位数少于格式字符串中的零(在小数的任一侧)，则格式化的值将显示前导或尾随零。<br /><br />如果数字的小数点分隔符右侧的位数多于格式表达式中小数点分隔符右侧的零数，则格式化的值会将数字四舍五入到与有零数一样多的小数位。<br /><br />如果数字的小数点分隔符左侧的位数多于格式表达式中小数点分隔符左侧的零位数，则格式化的值将显示额外的位数而无需修改。 |
| # | **表示显示数字或不显示数字的数字占位符。**<br /><br />如果表达式在格式字符串中出现数字符号 ( # )的位置有一 个数字，则格式化的值将显示该数字。否则，格式化的值在该位置不显示任何内容。<br /><br />数字符号 ( # ) 占位符的工作方式与零 ( 0 ) 数字占位符类似，但如果数字的位数与格式表达式中小数点分隔符两侧的 # 字符数相同或更少，则不会显示前导零和尾随零。 |
| . | **表示一个小数占位符**，它决定了在小数点分隔符的左侧和右侧显示的位数.<br /><br />如果格式表达式仅包含句点 ( . ) 左侧的数字符号 ( # ) 字符，则小于 1 的数字以小数分隔符开头。若要显示带小数的前导零，请使用零 (0) 作为小数点分隔符左侧的第一个数字占位符。 |
| % | **表示百分比占位符。**<br /><br />表达式乘以 100。百分比字符 ( % ) 插入格式字符串中百分比出现的位置。 |
| , | 表示在小数点分隔符左侧有四个或更多位的数字中将千位与百位分开的千位分隔符。 |
| E- E+ e- e+ | **表示科学记数法。**<br /><br />如果格式表达式在 E- 、E+、e- 或 e+ 的右侧至少包含一个数字占位符（ 0 或 # ），则以科学记数法格式显示格式化值，并在数字和其指数之间插入 E 或 e。 右侧的数字占位符数决定了指数中的位数。 使用 E- 或 e- 在负指数的后面包括一个减号。 使用 E + 或 e + 在负指数的后面包括一个减号，在正指数的后面包括一个加号。 |
| + - $  (   ) | **显示文字字符。**<br /><br />推荐用法如下：<br />+：用于正值<br />- 或 ( )：用于负值<br />$：用于货币符号 |
| \ | **显示格式字符串中的下一个字符。**<br /><br />若要将具有特殊含义的字符显示为文字字符，请在该字符前加上一个反斜杠 (\\\) 。 反斜杠本身不显示。若要显示反斜杠，请使用两个反斜杠 (\\) 。 <br /><br />不能显示为文字字符的字符包括下列：<br /># 、 0、 % 、 E、 e、 , 和 . |
