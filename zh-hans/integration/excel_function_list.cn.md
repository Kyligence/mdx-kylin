## Excel 功能支持列表

### 前置条件

以下功能需要 Excel 2010 及以上版本

### 数据连接

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| :--------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| SSAS 连接入口 - 使用账号密码认证                           | 支持                                                         | 数据 - 获取数据 - 来自数据库 - SSAS                          | 连接过程中需要勾选 **在文件中保存密码** 和 **总是尝试使用文件来刷新** ，否则将可能需要频繁输入认证信息来保持连接 |
| 现有连接                                                   | 支持                                                         | 数据 - 现有连接                                              | 现有连接有两种方式，选择**此工作簿中的连接**，将会使新建的透视表使用相同连接，选择**此计算机的连接文件**，会新创建一个连接副本，新建的透视表会使用新的连接副本。另外数据刷新时，同一个连接的透视表将会一并更新 |
| 插入透视表                                                 | 支持                                                         | 插入-透视表-外部连接                                         | 可以选择 SSAS 之外的连接入口，比如 XMLA Connect              |
| 脱机文件导入                                               | 不支持                                                       | 拖拽`.cub` 文件至 Excel 中                                   | Excel 支持从多维服务器中抽取数据，生成 `.cub` 文件，用于离线分析 |

### 透视表分析

#### 在 Excel 透视表中使用语义实体

以下是可在透视表中使用的语义实体

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span> |
| ---------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | ---------------------------------------------------------- |
| 度量组                                                   | 支持                                                         | 透视表字段                                                   | 默认每个模型对应一个度量组，计算度量单独一个度量组     |
| 度量文件夹                                                 | 支持                                                         | 透视表字段                                                   |                                                            |
| 维度表                                                     | 支持                                                         | 透视表字段                                                   | 公共维表仅会显示一个                                       |
| 命名集                                                     | 支持                                                         | 透视表字段                                                   |                                                            |
| 命名集文件夹                                               | 支持                                                         | 透视表字段                                                   | 命名集定义后默认在集合文件夹显示                           |
| 层级维度                                                   | 支持                                                         | 透视表字段                                                   |                                                            |
| 普通维度                                                   | 支持                                                         | 透视表字段                                                   |                                                            |
| 维度文件夹                                                 | 支持                                                         | 透视表字段                                                   |                                                            |

#### 字段选择和搜索

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 筛选区域                                                   | 支持                                                         | 透视表字段                                                   | 支持对普通维度和层级维度进行筛选                             |
| 行区域                                                     | 支持                                                         | 透视表字段                                                   | 可以选择普通维度，层级维度和命名集。                         |
| 列区域                                                     | 支持                                                         | 透视表字段                                                   | 可以选择普通维度，层级维度和命名集。点选时间维度时，时间维度会默认放置在行区域。 |
| 值区域                                                     | 支持                                                         | 透视表字段                                                   | 可以选择多个度量。当度量超过两个时，将在列区域默认生成数值维度。 |
| 字段搜索                                                   | 支持                                                         | 透视表字段                                                   | 可以在搜索框中搜索维度、度量、层级、命名集                   |

#### 筛选功能

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 筛选区域筛选                                               | 支持                                                         | 筛选区域对字段筛选                                           | 支持筛选普通维度和层级维度，支持单选和多选，支持模糊查询     |
| 行列字段筛选                                               | 支持                                                         | 行区域对字段筛选                                             | 支持筛选普通维度和层级维度，支持单选和多选，支持模糊查询     |
| 仅保留所选项目隐藏所选项目                                 | 支持                                                         | 列区域对字段筛选                                             | 属于列表筛选，不能和值筛选，标签筛选共存   |
| TopN 筛选                                                  | 支持                                                         | 透视表右键菜单 - 筛选                                        | 属于值筛选的一种；多个维度 TopN，不能联动生效；Hierarchy 多个 Level TopN，可能会导致数据不准确 |
| 值筛选                                                     | 支持                                                         | 透视表右键菜单 - 筛选                                        | 需要配置参数 insight.mdx.mondrian.mdprop.mdx.subqueries 开启子查询，详见[基本配置参数](../configuration/properties.cn.md)；值筛选和标签筛选不能同时生效；对于单字符 等于/不等于/结尾是/结尾不是/大于/小于等于/介于/不介于 查询结果有误；对Hierarchy值筛选后，不可展开；筛选后均不可展示总计 |
| 标签筛选                                                   | 支持                                                         | 透视表右键菜单 - 筛选                                        | 需要配置参数 insight.mdx.mondrian.mdprop.mdx.subqueries 开启子查询，详见[基本配置参数](../configuration/properties.cn.md)；值筛选和标签筛选不能同时生效；对于单字符 等于/不等于/结尾是/结尾不是/大于/小于等于/介于/不介于 查询结果有误；对Hierarchy标签筛选后，不可展开；筛选后均不可展示总计 |
| 切片器筛选                                                 | 支持                                                         | 透视表分析                                                   | 属于列表筛选                                                 |
| 日程表筛选                                                 | 不支持                                                       | 透视表分析                                                   | 属于列表筛选，滑块形式                                       |
| Excel 列复制筛选                                           | 支持                                                         | 复制透视表字段 - 字段筛选                                    | 复制 Excel 中的一列至空白行，对该列进行筛选，属于 Excel 内部筛选 |

#### 排序功能

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 数据源排序                                                 | 支持                                                         | 透视表右键菜单 - 排序                                        | 默认是按 SQL 中的字段排序，可以设置 Key Column / Name column 来更改排序显示 |
| 手动排序                                                   | 支持                                                         | 透视表右键菜单 - 移动                                        | 通过 move 功能进行自定义排序                                 |
| 指定字段排序                                               | 支持                                                         | 透视表右键菜单 - 排序                                        | 根据所选字段排序，与其他排序手段不能共存                     |

#### 布局显示

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 显示格式                                                   | 支持                                                         | 透视表右键菜单 - 单元格格式                                  | 可以在数据集设计阶段设置度量显示格式，如显示金额符号 $, ￥等，也可以在 Excel 上设置 |
| 显示总计                                                   | 支持                                                         | 设计 - 分类汇总                                              | 一般来说基数小的列放在左边，性能更佳                         |
| 显示小计                                                   | 支持                                                         | 设计 - 分类汇总                                              | 一般来说基数小的列放在左边，性能更佳                         |
| 汇总包含筛选项                                             | 不支持                                                       | 设计 - 分类汇总                                              | 对列进行筛选后，总计会依据筛选进行变化。该功能支持总计不依据筛选项进行变化 |
| 显示折叠/收缩按钮                                          | 部分支持                                                     | 透视表分析 - 显示                                            | 如果是层级维度，默认带 `+/-` 按钮。如果是多个普通维度，目前不会生成 `+/-` 按钮。 |
| 行显示空数据项                                             | 不支持                                                       | 透视表右键菜单 - 数据透视表选项 - 显示                       | 默认行上所有度量为空时，该行将会被隐藏                       |
| 列显示空数据项                                             | 不支持                                                       | 透视表右键菜单 - 数据透视表选项 - 显示                       | 默认列上所有度量为空时，该列将会被隐藏                       |
| 显示字段标题                                               | 支持                                                         | 透视表右键菜单 - 数据透视表选项 - 显示                       |                                                              |
| 显示字段列表                                               | 支持                                                         | 透视表分析 - 显示                                            |                                                              |
| Tooltip 显示属性                                           | 不支持                                                       | 透视表右键菜单                                               |                                                              |
| 报表上显示属性                                             | 不支持                                                       | 透视表右键菜单                                               |                                                              |
| 分组显示空行                                               | 支持                                                         | 设计 - 空行                                                  | 勾选后将在每个分组后显示空行                                 |
| 字段展开                                                   | 支持                                                         | 透视表右键菜单 - 展开                                        | 支持展开一层和全部展开                                       |
| 字段折叠                                                   | 支持                                                         | 透视表右键菜单 - 折叠                                        | 支持折叠一层和全部折叠                                       |
| 层级向下钻取                                               | 部分支持                                                     | 透视表分析                                                   | 目前只能最多下钻两层，开启子查询后可以下钻多层               |
| 层级向上钻取                                               | 部分支持                                                     | 透视表分析                                                   | 功能不完善，见上                                             |
| 标签重复显示                                               | 支持                                                         | 设计 - 报表布局                                              |                                                              |
| 压缩形式布局                                               | 支持                                                         | 设计 - 报表布局                                              |                                                              |
| 大纲形式布局                                               | 支持                                                         | 设计 - 报表布局                                              |                                                              |
| 表格形式布局                                               | 支持                                                         | 设计 - 报表布局                                              |                                                              |

#### 数据更新

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 延迟布局更新                                               | 支持                                                         | 数据透视表字段                                               | 仅更新数据，但不会更新结构。如果结构有变更（维度/度量缺失），将会报错 |
| 透视表右键更新                                             | 支持                                                         | 数据透视表右键                                               | 既更新数据，又更新结构。如果结构有变更，报表将自适应变更，可能会移除相关维度/度量，或者清空整个报表 |
| 数据 - 刷新                                                | 支持                                                         | 数据 - 刷新                                                  | 同上，会更新同一连接的所有报表                               |
| 全部刷新                                                   | 支持                                                         | 数据                                                         | 会更新所有连接的所有报表                                     |

#### 多维数据集函数

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| CubeMember                                                 | 支持                                                         | 单元格输入公式                                               | 返回多维数据集中的成员或元组。 用于验证多 维数据集内是否存在成员或元组 |
| CubeValue                                                  | 支持                                                         | 单元格输入公式                                               | 从多维数据集中返回汇总值                                     |
| CubeSet                                                    | 不支持                                                       | 单元格输入公式                                               | 定义成员或元组的计算集。方法是向服务器上的多维数据集发送一个集合表达式，此表达式创建集合，并随后将该集合返回到 Microsoft Excel |
| CubeSetCount                                               | 不支持                                                       | 单元格输入公式                                               | 返回集合中的项目数                                           |
| CubeKPIMember                                              | 不支持                                                       | 单元格输入公式                                               | 返回重要性能指示器 (KPI) 属性，并在单元格中显示 KPI 名称。 KPI 是一种用于监控单位绩效的可计量度量值，如每月总利润或季度员工调整 |
| CubeMemberProperty                                         | 不支持                                                       | 单元格输入公式                                               | 返回多维数据集中成员属性的值。 用于验证多维数据集内是否存在某个成员名并返回此成员的指定属性 |
| CubeRankedMember                                           | 支持                                                         | 单元格输入公式                                               | 返回集合中的第 n 个或排在一定名次的成员。 用来返回集合中的一个或多个元素，如业绩最好的销售人员或前 10 名的学生 |

#### 高级功能

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span> |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------------------------------- |
| ESC 取消查询                                               | 支持                                                         | 查询过程中键入 ESC                                           | 集群情况下可能存在问题                                     |
| 快速计算                                                   | 支持                                                         | 透视表右键菜单 - 值显示方式                                  | 类似 Tableau 的表计算功能                                  |
| 创建/取消分组                                              | 支持                                                         | 透视表右键菜单                                               | 在头部-长尾场景分析中常见，长尾归类为 Others               |
| 钻取明细                                                   | 不支持                                                     | 透视表右键菜单                                               | 可以双击度量组钻取明细                                     |
| 基于行创建集合                                             | 不支持                                                       | 透视表分析 - 字段、项目和集                                  | 可以在 MDX for Kylin 数据集界面定义                        |
| 基于 MDX 创建集合                                          | 不支持                                                       | 透视表分析 - 字段、项目和集                                  | 可以在 MDX for Kylin 数据集界面定义                        |
| 创建计算度量                                               | 不支持                                                       | 透视表分析 - OLAP 工具                                       | 可以在 MDX for Kylin 数据集界面定义                        |
| 创建计算成员                                               | 不支持                                                       | 透视表分析 - OLAP 工具                                       | 可以在 MDX for Kylin 数据集界面定义                        |
| 模拟分析                                                   | 不支持                                                       | 透视表分析 - OLAP 工具                                       | 需要具备数据回写功能                                       |
| 脱机分析                                                   | 不支持                                                       | 透视表分析 - OLAP 工具                                       |                                                            |


### 报表制作

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 插入图表                                                   | 支持                                                         | 插入 - 图表                                                  | 可以选择各种类型的图表来进行数据可视化                       |
| 筛选器联动                                                 | 支持                                                         | 透视表分析 - 筛选器连接                                      | 筛选器设置关联多个透视表后，可进行联动分析，在仪表板中经常使用 |

### 报表分享

| <span style="display:inline-block;width:120px">功能</span> | <span style="display:inline-block;width:70px">支持状态</span> | <span style="display:inline-block;width:160px">操作路径</span> | <span style="display:inline-block;width:200px">备注</span>   |
| ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 数据源切换                                                 | 支持                                                         | 透视表分析 - 更改数据源                                      | 此操作会更新结构，并更新数据。如果结构有变更，报表将自适应变更，可能会移除相关维度/度量，或者清空整个报表 |
